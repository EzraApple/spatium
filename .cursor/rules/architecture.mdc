---
alwaysApply: true
---

```markdown
# Architecture Rules

## Monorepo Structure

Turborepo + pnpm workspace monorepo.

- `apps/web` - Vite + React frontend (fully client-side, interactive editor)
- `apps/party` - PartyKit WebSocket server (room state, real-time sync)
- `packages/shared` - Shared types, constants, utilities

Cross-app imports use `@apartment-planner/shared`. Never import directly between apps.

## Environment Config

Both apps use an `env.ts` with auto-detection:

```typescript
// apps/web/src/lib/env.ts
const isDev = import.meta.env.DEV

export const env = {
  PARTYKIT_HOST: isDev ? "localhost:1999" : "your-project.partykit.dev",
} as const
```

```typescript
// apps/party/src/lib/env.ts
const isDev = process.env.NODE_ENV !== "production"

export const env = {
  // Party-specific env vars
} as const
```

All env access goes through `env.ts`. Auto-detect dev/prod, no manual switching.

## Import Aliases

- `@/` resolves to `src/` within each app
- `@apartment-planner/shared` for cross-package imports

## File Naming

- Components: `kebab-case.tsx`
- Hooks: `use-[name].ts`
- Utils/lib: `kebab-case.ts`
- Handlers: `[message-type].ts`
- One component per file, named export matching filename
```